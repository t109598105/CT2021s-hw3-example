<!DOCTYPE html><html><head><meta charset=utf-8><title>Text Drawer</title><style>@import url(https://fonts.googleapis.com/css2?family=Open+Sans:wght@300&display=swap);*{margin:0;padding:0;font-family:'Open Sans',sans-serif;box-sizing:border-box}#root{height:100vh;width:100vw;padding:1rem;position:relative;background-color:#6b4c9c38}#root:after{content:"";clear:both}#root #container,#root #svg-text{float:left;width:45%;display:inline-block;height:100%;padding:20px;margin-right:10px;border-style:solid;border-width:1px}#root #svg-text textarea{resize:none;height:100%;width:100%;font-size:10px}#root #container{position:relative}#root #container #drag-tip{position:absolute;top:0;bottom:0;right:0;left:0;height:100%;width:100%;background-color:rgba(10,10,10,.253);display:none}#root #container #drag-tip.dragged{display:table}#root #container #drag-tip div{font-size:100px;vertical-align:middle;text-align:center;display:table-cell}#root #side-bar{float:left;width:8%;display:inline-block;height:100%;border-style:solid;border-width:1px}#root #side-bar .item{padding:.5rem}.my-btn{padding:5px 10px;color:#fff;background-color:#242477;cursor:pointer}svg{cursor:url(pen.svg),auto}</style></head><body><div id=root><div id=container><div id=drag-tip><div>Drag your picture here</div></div></div><div id=svg-text><textarea id=svg-text-area readonly=readonly>  </textarea></div><div id=side-bar><div class=item id=score-btn></div><div class=item><div id=bg-switch class=my-btn>CloseBG</div></div><div class=item><div id=export-svg class=my-btn>Export</div></div><div class=item><div id=clear-btn class=my-btn>Clear</div></div></div></div><script src=https://d3js.org/d3.v3.min.js></script><script src=https://cdn.jsdelivr.net/gh/t109598105/ScoreOutputer@latest/dist/scoreoutputer.min.js></script><script>d3.select(window).on("load",function(){function a(){t.html(""),t.html(r.html().replace(/\<div(.*)?\<\/div>\<\/div\>/,"").replace(/href\=\"data\:image\/(.*)?\"/,'href="data:image...."').trim())}function e(t,e){var n=new FileReader;n.onload=function(){l.selectAll("image").remove(),l.append("image").attr("href",n.result).attr("width","100%").attr("height","100%").attr("x",0).attr("y",0),"function"==typeof e&&e(),a()},n.readAsDataURL(t)}var l,r=d3.select("#container"),t=d3.select("#svg-text-area"),n=(r.node().getBoundingClientRect().width,46),d=!0,o=new Array(n*n).fill(0),i=r.append("svg").attr("width","100%").attr("height","100%").attr("viewBox","0 0 920 920").attr("xmlns","http://www.w3.org/2000/svg"),c=!1,s=!1,f=(i.selectAll("*").remove(),i.selectAll("rect").data(o).enter().append("rect").attr("transform",function(t,e){return"translate("+e%n*20+","+20*Math.floor(e/n)+")"}).attr("stroke","black").attr("stroke-width",".1px").attr("fill",function(t){return t?"black":"white"}).attr("width",20).attr("height",20).on("contextmenu",function(t,e){d3.event.preventDefault()}).on("mousedown",function(t,e){Math.floor(e/n);0==d3.event.button?(c=!0,d3.select(this).attr("fill","black"),o[e]=1,a()):2==d3.event.button&&(s=!0,d3.select(this).attr("fill","white"),o[e]=0,a())}).on("mousemove",function(t,e){Math.floor(e/n);c?(d3.select(this).attr("fill","black"),o[e]=1,a()):s&&(d3.select(this).attr("fill","white"),o[e]=0,a())}).on("mouseup",function(t,e){0==d3.event.button?c=!1:2==d3.event.button&&(s=!1)}),l=i.append("g").attr("style","opacity: 0.3;pointer-events: none;").attr("display",d?"":"none"),r.on("dragenter",function(){d3.event.preventDefault(),d3.select("#drag-tip").classed("dragged",!0)}).on("dragover",function(){d3.event.preventDefault()}).on("drop",function(){d3.event.preventDefault(),d3.select("#drag-tip").classed("dragged",!1);var t=d3.event.dataTransfer.files[0];return"dat"==t.name.split(".").slice(-1)[0]?dataReader(t):t.type.startsWith("image/")?void e(t):console.error("Not a valid image type")}),d3.select("#export-svg").on("click",function(){var t=d3.select(r.node().cloneNode(!0)),e=(t.selectAll("div").remove(),t.html().trim()),n=t.append("a").attr("href",URL.createObjectURL(new Blob([e],{type:"image/svg+xml"}))).attr("download","export.svg");n.node().click(),window.setTimeout(function(){URL.revokeObjectURL(n.attr("href"))},50)}),a(),d3.select("#bg-switch").on("click",function(){(d=!d)?d3.select(this).text("CloseBG"):d3.select(this).text("ShowBG"),d?l.attr("display",""):l.attr("display","none"),a()}),d3.select("#clear-btn").on("click",function(){i.selectAll("rect").attr("fill","white"),o.fill(0)}),new ScoreOutputer("109598105"));f.installCSS(function(){f.addChild("繪製 46x46 格子",4,!1),f.addChild("讀取圖片背景",2,!1),f.addChild("輸出 SVG",2,!1),f.addChild("SVG Text 即時同步",1,!1),f.addChild("開關背景圖片功能",1,!1),f.renderModal(document.body,"rgba(100,45,58,1)","white","15pt","15px","自我評分表"),f.installDownloadBtn(),f.renderBtn(d3.select("#score-btn").node(),"開啟自評表")})})</script></body></html>